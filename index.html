<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Harmony - Music Player</title>
  <link rel="icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Apple_Music_icon.svg/2048px-Apple_Music_icon.svg.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #ff0000;
      --primary-dark: #cc0000;
      --accent: #1db954;
      --dark: #0f0f0f;
      --darker: #1a1a1a;
      --darkest: #000;
      --light: #ffffff;
      --gray: #aaaaaa;
      --gray-dark: #606060;
      --transition: all 0.3s ease;
      --sidebar-width: 280px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--darkest) 0%, var(--darker) 100%);
      color: var(--light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(30, 30, 30, 0.3);
      border-radius: 5px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--primary);
      border-radius: 5px;
      transition: var(--transition);
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #ff4d4d;
    }

    .app-container {
      display: flex;
      flex: 1;
      min-height: 100vh;
    }

    /* Premium Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      background: rgba(15, 15, 15, 0.95);
      height: 100vh;
      display: flex;
      flex-direction: column;
      border-right: 1px solid rgba(255, 255, 255, 0.05);
      overflow-y: auto;
      transition: var(--transition);
      z-index: 10;
      position: fixed;
      box-shadow: 5px 0 15px rgba(0, 0, 0, 0.3);
    }

    .logo-container {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      background: linear-gradient(to right, rgba(255,0,0,0.2), transparent);
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .logo {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--light);
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }

    .logo span {
      background: linear-gradient(45deg, var(--primary), #ff6b6b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
    }

    .logo i {
      font-size: 1.5rem;
      color: var(--primary);
    }

    .nav-links {
      padding: 2rem 0;
    }

    .nav-item {
      display: flex;
      align-items: center;
      padding: 1rem 1.8rem;
      cursor: pointer;
      transition: var(--transition);
      color: var(--gray);
      text-decoration: none;
      position: relative;
      overflow: hidden;
      font-size: 1.1rem;
      font-weight: 500;
    }

    .nav-item:hover, .nav-item.active {
      background: linear-gradient(to right, rgba(255,0,0,0.15), transparent);
      color: var(--light);
    }

    .nav-item:hover::before, .nav-item.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 4px;
      background: var(--primary);
    }

    .nav-item i {
      margin-right: 1.2rem;
      width: 24px;
      text-align: center;
      font-size: 1.2rem;
    }

    .favorites-count, .history-count {
      margin-left: auto;
      background: linear-gradient(45deg, var(--primary), #ff6b6b);
      color: white;
      font-size: 0.8rem;
      padding: 0.2rem 0.6rem;
      border-radius: 12px;
      font-weight: 600;
    }

    /* Premium Main Content */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      margin-left: var(--sidebar-width);
      background: url('https://images.unsplash.com/photo-1470225620780-dba8ba36b745?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80') no-repeat center center;
      background-size: cover;
      position: relative;
      min-height: 100vh;
    }

    .main-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(10, 10, 10, 0.85);
      z-index: 0;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      background: rgba(15, 15, 15, 0.8);
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(10px);
    }

    .menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--light);
      font-size: 1.5rem;
      cursor: pointer;
      margin-right: 0.5rem;
    }

    .header-title {
      display: none;
      font-size: 1.3rem;
      font-weight: 600;
      margin-right: 1rem;
      background: linear-gradient(45deg, var(--primary), #ff6b6b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
    }

    .search-container {
      position: relative;
      flex: 1;
      max-width: 700px;
      margin: 0 1rem;
    }

    .search-input {
      width: 100%;
      padding: 0.9rem 1rem 0.9rem 3rem;
      border-radius: 30px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(30, 30, 30, 0.7);
      color: var(--light);
      font-size: 1rem;
      transition: var(--transition);
      backdrop-filter: blur(5px);
      font-weight: 500;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--primary);
      background: rgba(15, 15, 15, 0.9);
      box-shadow: 0 0 0 3px rgba(255, 0, 0, 0.3);
    }

    .search-icon {
      position: absolute;
      left: 1.3rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
      font-size: 1rem;
    }

    /* Premium Tab Content */
    .tab-content {
      flex: 1;
      padding: 1.5rem;
      overflow-y: auto;
      display: none;
      position: relative;
      z-index: 1;
      height: calc(100vh - 180px);
    }

    .tab-content.active {
      display: block;
    }

    .results-title {
      font-size: 1.6rem;
      margin-bottom: 1.5rem;
      color: var(--light);
      font-weight: 700;
      position: relative;
      padding-bottom: 0.8rem;
    }

    .results-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 4px;
      background: var(--primary);
      border-radius: 2px;
    }

    .results-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 1.5rem;
      padding-bottom: 2rem;
    }

    .result-card {
      background: rgba(30, 30, 30, 0.7);
      border-radius: 12px;
      padding: 1rem;
      transition: var(--transition);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .result-card:hover {
      background: rgba(50, 50, 50, 0.8);
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4);
    }

    .result-image {
      width: 100%;
      aspect-ratio: 16/9;
      border-radius: 8px;
      margin-bottom: 1rem;
      object-fit: cover;
      transition: var(--transition);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }

    .result-card:hover .result-image {
      transform: scale(1.03);
    }

    /* Fixed title display */
    .result-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      line-height: 1.4;
      min-height: 2.8em;
      max-height: 3.2em;
      text-overflow: ellipsis;
    }

    .result-channel {
      font-size: 0.85rem;
      color: var(--gray);
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .card-actions {
      position: absolute;
      top: 0.8rem;
      right: 0.8rem;
      display: flex;
      gap: 0.8rem;
      z-index: 2;
      opacity: 0;
      transition: var(--transition);
    }

    .result-card:hover .card-actions {
      opacity: 1;
    }

    .action-btn {
      width: 30px;
      height: 30px;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--light);
      font-size: 0.9rem;
      transition: var(--transition);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .action-btn:hover {
      background: var(--primary);
      transform: scale(1.15);
    }

    .favorite-btn.favorited i {
      color: var(--primary);
    }

    .play-button {
      position: absolute;
      bottom: 1.5rem;
      right: 1.5rem;
      width: 40px;
      height: 40px;
      background: var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: translateY(10px);
      transition: var(--transition);
      box-shadow: 0 4px 12px rgba(255, 0, 0, 0.3);
      z-index: 2;
    }

    .result-card:hover .play-button {
      opacity: 1;
      transform: translateY(0);
    }

    .play-button i {
      color: var(--light);
      font-size: 1rem;
      margin-left: 2px;
    }

    /* Premium Player Controls */
    .player-controls {
      position: fixed;
      bottom: 0;
      left: var(--sidebar-width);
      right: 0;
      height: 90px;
      background: rgba(20, 20, 20, 0.95);
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      display: flex;
      align-items: center;
      padding: 0 1.5rem;
      z-index: 100;
      box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
    }

    .now-playing {
      display: flex;
      align-items: center;
      gap: 1rem;
      width: 30%;
      min-width: 0;
    }

    .now-playing-image {
      width: 60px;
      height: 60px;
      border-radius: 8px;
      object-fit: cover;
      flex-shrink: 0;
      transition: var(--transition);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      background: #333; /* Fallback color */
    }

    .now-playing-info {
      display: flex;
      flex-direction: column;
      min-width: 0;
      overflow: hidden;
    }

    /* Fixed song title display */
    .now-playing-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.2rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }

    .now-playing-artist {
      font-size: 0.85rem;
      color: var(--gray);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }

    .player-center {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      max-width: 600px;
    }

    .player-buttons {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      margin-bottom: 0.8rem;
    }

    .player-button {
      color: var(--gray);
      font-size: 1.2rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .player-button:hover {
      color: var(--light);
      transform: scale(1.1);
    }

    .player-button.play-pause {
      background: linear-gradient(135deg, var(--primary), #ff6b6b);
      color: var(--light);
      width: 45px;
      height: 45px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      transition: all 0.2s ease, transform 0.1s ease;
      box-shadow: 0 4px 12px rgba(255, 0, 0, 0.3);
    }

    .player-button.play-pause:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 15px rgba(255, 0, 0, 0.4);
    }

    .player-button.play-pause:active {
      transform: scale(0.95);
    }

    .player-actions {
      display: flex;
      gap: 1.2rem;
      margin-left: 1.2rem;
    }

    .fav-btn {
      color: var(--gray);
      transition: var(--transition);
      font-size: 1.2rem;
    }

    .fav-btn:hover, .fav-btn.favorited {
      color: var(--primary);
      transform: scale(1.1);
    }

    .player-progress {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }

    .progress-time {
      font-size: 0.85rem;
      color: var(--gray);
      min-width: 40px;
      font-weight: 500;
    }

    .progress-bar {
      flex: 1;
      height: 5px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
      cursor: pointer;
      position: relative;
      transition: height 0.2s ease;
    }

    .progress-fill {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--primary), #ff6b6b);
      border-radius: 3px;
      transition: width 0.1s linear;
    }

    .progress-handle {
      position: absolute;
      top: 50%;
      right: -6px;
      width: 12px;
      height: 12px;
      background: var(--light);
      border-radius: 50%;
      transform: translateY(-50%);
      opacity: 0;
      transition: var(--transition);
      box-shadow: 0 0 8px rgba(255, 0, 0, 0.4);
    }

    .progress-bar:hover {
      height: 7px;
    }

    .progress-bar:hover .progress-handle,
    .progress-bar:active .progress-handle {
      opacity: 1;
    }

    /* Premium Spinner */
    .spinner-container {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 1s linear infinite;
      box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Premium Logs Tab */
    .logs-container {
      max-width: 900px;
      margin: 0 auto;
      overflow-y: auto;
      max-height: calc(100vh - 180px);
      padding-bottom: 2rem;
    }

    .log-card {
      background: linear-gradient(135deg, rgba(30,30,30,0.8), rgba(15,15,15,0.9));
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      border-left: 4px solid var(--primary);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .log-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .log-version {
      background: linear-gradient(45deg, var(--primary), #ff6b6b);
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.95rem;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(255, 0, 0, 0.2);
    }

    .log-date {
      color: var(--gray);
      font-size: 0.95rem;
      font-weight: 500;
    }

    .log-title {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--light);
      font-weight: 700;
    }

    .log-features {
      list-style-type: none;
      padding-left: 1.2rem;
    }

    .log-features li {
      margin-bottom: 0.8rem;
      position: relative;
      padding-left: 1.8rem;
      font-size: 1rem;
      line-height: 1.5;
    }

    .log-features li:before {
      content: '';
      position: absolute;
      left: 0;
      top: 0.5rem;
      width: 10px;
      height: 10px;
      background: var(--primary);
      border-radius: 50%;
      box-shadow: 0 0 5px rgba(255,0,0,0.5);
    }

    /* Enhanced Trademark Page Styles */
    .trademark-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
      background: rgba(30, 30, 30, 0.7);
      border-radius: 12px;
      border-left: 4px solid var(--primary);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .trademark-header {
      text-align: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .trademark-header h2 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      background: linear-gradient(45deg, var(--primary), #ff6b6b);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 2px 8px rgba(255,0,0,0.2);
    }

    .trademark-header p {
      color: var(--gray);
      font-size: 1rem;
      letter-spacing: 0.5px;
    }

    .trademark-section {
      margin-bottom: 2.5rem;
      padding: 1.5rem;
      background: rgba(20, 20, 20, 0.5);
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.05);
    }

    .trademark-section h3 {
      font-size: 1.4rem;
      margin-bottom: 1.2rem;
      color: var(--light);
      padding-bottom: 0.5rem;
      border-bottom: 2px solid var(--primary);
      display: inline-block;
    }

    .trademark-section p {
      margin-bottom: 1.2rem;
      line-height: 1.7;
      color: var(--gray);
      font-size: 1.05rem;
    }

    .trademark-section ul {
      padding-left: 2rem;
      margin-bottom: 1.5rem;
    }

    .trademark-section li {
      margin-bottom: 0.8rem;
      position: relative;
      line-height: 1.6;
      color: var(--gray);
    }

    .trademark-section li:before {
      content: '•';
      color: var(--primary);
      font-weight: bold;
      font-size: 1.2rem;
      position: absolute;
      left: -1.2rem;
      top: -0.1rem;
    }

    .license-highlight {
      background: rgba(255,0,0,0.1);
      padding: 1.5rem;
      border-radius: 8px;
      border-left: 3px solid var(--primary);
      margin: 1.5rem 0;
    }

    .license-highlight p {
      margin-bottom: 0.8rem;
    }

    .admin-note {
      background: linear-gradient(135deg, rgba(255,0,0,0.1), rgba(30,30,30,0.3));
      border-left: 3px solid var(--primary);
      padding: 1.5rem;
      margin: 2.5rem 0;
      border-radius: 8px;
      position: relative;
      overflow: hidden;
    }

    .admin-note:before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.03));
      pointer-events: none;
    }

    .admin-note p {
      color: var(--light);
      font-style: italic;
      position: relative;
      z-index: 1;
      line-height: 1.7;
    }

    .legal-text {
      font-size: 0.85rem;
      color: var(--gray-dark);
      margin-top: 3rem;
      border-top: 1px solid rgba(255,255,255,0.1);
      padding-top: 1.5rem;
      line-height: 1.6;
      text-align: center;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 3rem 1.5rem;
      color: var(--gray);
      background: rgba(30, 30, 30, 0.5);
      border-radius: 12px;
      max-width: 500px;
      margin: 1.5rem auto;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .empty-state i {
      font-size: 4rem;
      margin-bottom: 1.2rem;
      opacity: 0.3;
      background: linear-gradient(45deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: var(--light);
      font-weight: 700;
    }

    .empty-state p {
      font-size: 1rem;
      max-width: 400px;
      margin: 0 auto;
      line-height: 1.6;
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .sidebar {
        left: 0;
      }
      
      .main-content {
        margin-left: var(--sidebar-width);
      }
      
      .player-controls {
        left: var(--sidebar-width);
      }
    }

    @media (max-width: 992px) {
      .sidebar {
        left: -280px;
      }
      
      .sidebar.active {
        left: 0;
      }
      
      .main-content {
        margin-left: 0;
      }
      
      .player-controls {
        left: 0;
      }
      
      .menu-toggle {
        display: block;
      }
      
      .header-title {
        display: block;
      }
      
      header {
        padding: 0.8rem 1rem;
      }
      
      .search-container {
        margin: 0 0.5rem;
      }
      
      .search-input {
        padding: 0.8rem 1rem 0.8rem 2.8rem;
        font-size: 0.95rem;
      }
      
      .search-icon {
        left: 1rem;
      }
      
      .now-playing {
        width: 60%;
      }
      
      .now-playing-image {
        width: 50px;
        height: 50px;
      }
      
      .player-buttons {
        gap: 1rem;
      }
      
      .results-container {
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: 1.2rem;
      }
      
      /* Improved text display for mobile */
      .result-title {
        font-size: 0.95rem;
        min-height: 2.6em;
      }
    }

    @media (max-width: 768px) {
      .results-container {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 1rem;
      }
      
      .player-controls {
        height: 110px;
        flex-direction: column;
        padding: 0.8rem;
        align-items: flex-start;
      }
      
      .now-playing {
        width: 100%;
        margin-bottom: 0.5rem;
      }
      
      .player-center {
        width: 100%;
      }
      
      .player-actions {
        position: absolute;
        right: 0.8rem;
        top: 0.8rem;
      }
      
      .log-card {
        padding: 1.2rem;
      }
      
      .log-title {
        font-size: 1.2rem;
      }
      
      .log-features li {
        font-size: 0.95rem;
        padding-left: 1.5rem;
      }
      
      .tab-content {
        padding: 1.2rem;
        height: calc(100vh - 150px);
      }
      
      .trademark-container {
        padding: 1.2rem;
      }
      
      .legal-text {
        padding: 1rem;
        margin-top: 2rem;
      }
    }

    @media (max-width: 480px) {
      .results-container {
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
        gap: 0.8rem;
      }
      
      .player-controls {
        height: 120px;
      }
      
      .player-buttons {
        gap: 0.8rem;
        margin-bottom: 0.5rem;
      }
      
      .player-button {
        font-size: 1.1rem;
      }
      
      .player-button.play-pause {
        width: 40px;
        height: 40px;
      }
      
      .progress-time {
        font-size: 0.8rem;
      }
      
      .now-playing-info {
        max-width: 160px;
      }
      
      .tab-content {
        padding: 1rem;
        height: calc(100vh - 140px);
      }
      
      .result-title {
        font-size: 0.9rem;
        min-height: 2.4em;
      }
      
      .results-title {
        font-size: 1.4rem;
      }
      
      .trademark-header h2 {
        font-size: 1.5rem;
      }
      
      .trademark-section {
        padding: 1rem;
      }
      
      .legal-text {
        font-size: 0.75rem;
        padding: 0.8rem 0;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Premium Sidebar -->
    <div class="sidebar" id="sidebar">
      <div class="logo-container">
        <i class="fas fa-music"></i>
        <div class="logo">
          <span>Harmony</span>
        </div>
      </div>
      
      <div class="nav-links">
        <div class="nav-item active" data-tab="home">
          <i class="fas fa-home"></i>
          <span>Home</span>
        </div>
        <div class="nav-item" data-tab="favorites">
          <i class="fas fa-heart"></i>
          <span>Favorites</span>
          <span class="favorites-count" id="favoritesCount">0</span>
        </div>
        <div class="nav-item" data-tab="history">
          <i class="fas fa-history"></i>
          <span>History</span>
          <span class="history-count" id="historyCount">0</span>
        </div>
        <div class="nav-item" data-tab="logs">
          <i class="fas fa-clipboard-list"></i>
          <span>Update Logs</span>
        </div>
        <!-- New Trademark Tab -->
        <div class="nav-item" data-tab="trademark">
          <i class="fas fa-copyright"></i>
          <span>Trademark</span>
        </div>
      </div>
      
      <!-- Now Playing Preview -->
      <div class="now-playing-preview" style="padding: 1.2rem; margin-top: auto; border-top: 1px solid rgba(255,255,255,0.05);">
        <h3 style="font-size: 1rem; margin-bottom: 0.8rem; color: var(--light); font-weight: 500;">Now Playing</h3>
        <div class="now-playing">
          <img src="" alt="Now Playing" class="now-playing-image" id="sidebarNowPlayingImage" style="width: 45px; height: 45px; background: #333;">
          <div class="now-playing-info">
            <div class="now-playing-title" id="sidebarNowPlayingTitle" style="font-size: 0.9rem;">Not Playing</div>
            <div class="now-playing-artist" id="sidebarNowPlayingArtist" style="font-size: 0.75rem;">Search for a song</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Premium Main Content -->
    <div class="main-content">
      <header>
        <button class="menu-toggle" id="menuToggle">
          <i class="fas fa-bars"></i>
        </button>
        <div class="header-title">Harmony</div>
        
        <div class="search-container">
          <i class="fas fa-search search-icon"></i>
          <input type="text" class="search-input" placeholder="Search for songs, artists, or albums..." id="searchInput" autocomplete="off">
        </div>
      </header>
      
      <!-- Home Tab -->
      <div class="tab-content active" id="homeTab">
        <div class="search-results" id="searchResults">
          <h2 class="results-title">Search Results</h2>
          <div class="results-container" id="resultsContainer"></div>
        </div>
      </div>
      
      <!-- Favorites Tab -->
      <div class="tab-content" id="favoritesTab">
        <h2 class="results-title">Your Favorites</h2>
        <div class="results-container" id="favoritesContainer"></div>
      </div>
      
      <!-- History Tab -->
      <div class="tab-content" id="historyTab">
        <h2 class="results-title">Recently Played</h2>
        <div class="results-container" id="historyContainer"></div>
      </div>
      
      <!-- Logs Tab -->
      <div class="tab-content" id="logsTab">
        <div class="logs-container">
          <h2 class="results-title">Update Logs</h2>
          
          <div class="log-card">
            <div class="log-header">
              <span class="log-version">v3.7</span>
              <span class="log-date">June 1, 2025</span>
            </div>
            <h3 class="log-title">Legal & Trademark Update</h3>
            <ul class="log-features">
              <li>Added comprehensive Trademark information section</li>
              <li>Expanded license documentation with full MIT terms</li>
              <li>Improved legal disclaimers and compliance notices</li>
              <li>Enhanced credits and acknowledgments section</li>
              <li>Updated UI for legal information display</li>
            </ul>
          </div>
          
          <div class="log-card">
            <div class="log-header">
              <span class="log-version">v3.5</span>
              <span class="log-date">May 30, 2025</span>
            </div>
            <h3 class="log-title">Scrolling Fixes Update</h3>
            <ul class="log-features">
              <li>Fixed scrolling issues on mobile and desktop</li>
              <li>Improved content container heights</li>
              <li>Added proper padding to all scrollable areas</li>
              <li>Optimized tab content overflow behavior</li>
              <li>Fixed player controls positioning</li>
              <li>Enhanced overall scrolling experience</li>
            </ul>
          </div>
          
          <div class="log-card">
            <div class="log-header">
              <span class="log-version">v3.4</span>
              <span class="log-date">May 28, 2025</span>
            </div>
            <h3 class="log-title">Bug Fixes & Enhancements</h3>
            <ul class="log-features">
              <li>Fixed favorite button functionality</li>
              <li>Improved track information storage</li>
              <li>Enhanced player controls responsiveness</li>
              <li>Fixed history playback issues</li>
              <li>Optimized state management</li>
            </ul>
          </div>
        </div>
      </div>
      
      <!-- New Trademark Tab -->
      <div class="tab-content" id="trademarkTab">
        <div class="trademark-container">
          <div class="trademark-header">
            <h2>Harmony Music Player</h2>
            <p>Legal Information, Credits & Acknowledgments</p>
          </div>
          
          <div class="trademark-section">
            <h3>Software License</h3>
            <p>Harmony Music Player is released under the <strong>MIT License</strong>, a permissive free software license originating at the Massachusetts Institute of Technology. This license places minimal restrictions on software reuse and provides legal protection for both users and developers.</p>
            
            <div class="license-highlight">
              <p><strong>Full MIT License Text:</strong></p>
              <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
              <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
              <p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
            </div>
            
            <p>This license allows for commercial use, modification, distribution, and private use of the software. The only condition is that the license and copyright notice must be included with any substantial portions of the code.</p>
            
            <p><strong>Harmony-Specific License Notes:</strong></p>
            <ul>
              <li>Harmony is provided as-is with no warranties or guarantees of functionality.</li>
              <li>The Harmony development team is not responsible for any damages resulting from the use of this software.</li>
              <li>Modifications to the Harmony source code must retain all original copyright notices.</li>
              <li>Distributions of modified versions must clearly indicate they are not the original Harmony software.</li>
              <li>The Harmony name and logo may not be used to endorse or promote products derived from this software without specific prior written permission.</li>
            </ul>
          </div>
          
          <div class="trademark-section">
            <h3>Harmony Project Information</h3>
            <p>Harmony is an open-source music player application designed to provide a seamless music streaming experience. The project was created with the following goals in mind:</p>
            <ul>
              <li>To create a beautiful, intuitive music player interface</li>
              <li>To demonstrate modern web development techniques</li>
              <li>To provide a learning resource for developers</li>
              <li>To offer a free alternative to commercial music players</li>
            </ul>
            
            <p><strong>Project Status:</strong></p>
            <p>Harmony is currently maintained as a hobby project by a small team of developers. While we strive to keep the application functional, we cannot guarantee continuous updates or support.</p>
            
            <p><strong>Source Code Availability:</strong></p>
            <p>The complete source code for Harmony is available on GitHub under the MIT license. Developers are encouraged to contribute improvements, report issues, or fork the project for their own use.</p>
          </div>
          
          <div class="trademark-section">
            <h3>Credits & Acknowledgments</h3>
            <p>Harmony Music Player was made possible through the use of several third-party services and resources:</p>
            <ul>
              <li><strong>YouTube API Services:</strong> Special thanks to Google LLC for providing the YouTube Data API v3 that powers this application's music streaming capabilities. This product uses the YouTube API but is not endorsed or certified by YouTube. By using this application, you agree to be bound by YouTube's Terms of Service.</li>
              <li><strong>Font Awesome:</strong> All icons used throughout the interface are provided by Font Awesome's free tier under the Font Awesome Free License.</li>
              <li><strong>Unsplash:</strong> Background image provided by Matthew Moloney under the Unsplash License which grants free use for both commercial and non-commercial purposes.</li>
              <li><strong>Community Contributors:</strong> We extend our gratitude to all users who provided valuable feedback, bug reports, and suggestions for improving Harmony.</li>
            </ul>
          </div>
          
          <div class="trademark-section">
            <h3>Trademark Protection</h3>
            <p>The name "Harmony", the Harmony logo, and all related names, logos, product and service names, designs, and slogans are trademarks of this project and may not be used without prior written permission.</p>
            <p>Unauthorized use, including but not limited to reproduction, modification, distribution, or republication of the Harmony branding elements is strictly prohibited without express written consent from the project administrators.</p>
            <p>This protection extends to any confusingly similar variations of the Harmony name or logo, as well as any use that might imply official endorsement or affiliation where none exists.</p>
            
            <p><strong>Permitted Uses:</strong></p>
            <ul>
              <li>Referencing Harmony in articles or reviews with proper attribution</li>
              <li>Linking to the official Harmony website or repository</li>
              <li>Using Harmony as intended by the software</li>
            </ul>
            
            <p><strong>Prohibited Uses:</strong></p>
            <ul>
              <li>Using the Harmony name or logo for commercial products without permission</li>
              <li>Creating derivative works that use the Harmony branding</li>
              <li>Implying official partnership or endorsement by the Harmony team</li>
            </ul>
          </div>
          
          <div class="trademark-section">
            <h3>Third-Party Compliance</h3>
            <p>This application complies with all relevant third-party terms of service:</p>
            <ul>
              <li><strong>YouTube Terms of Service:</strong> Compliance with YouTube's API Services Terms of Service, including all usage limitations and requirements.</li>
              <li><strong>Google Privacy Policy:</strong> Adherence to Google's privacy policies regarding data collection and usage.</li>
              <li><strong>Font Awesome License:</strong> Proper attribution and compliance with Font Awesome's free license requirements.</li>
              <li><strong>Unsplash License:</strong> Proper use of Unsplash images in accordance with their license terms.</li>
            </ul>
            
            <p><strong>YouTube API Compliance:</strong></p>
            <p>Harmony uses the YouTube API Services to stream music content. By using Harmony, you agree to be bound by the YouTube Terms of Service available at <a href="https://www.youtube.com/t/terms" style="color: var(--primary);">https://www.youtube.com/t/terms</a>.</p>
            <p>Harmony's use and transfer to any other app of information received from Google APIs will adhere to <a href="https://developers.google.com/terms/api-services-user-data-policy" style="color: var(--primary);">Google API Services User Data Policy</a>, including the Limited Use requirements.</p>
          </div>
          
          <div class="admin-note">
            <p><strong>From The Admin / Development Team:</strong> We sincerely thank our amazing community for supporting this passion project. Your enthusiasm and feedback drive us to continuously improve Harmony. Special recognition goes to Google for providing the YouTube API that makes this music experience possible. Harmony remains a non-commercial, educational project created by music lovers for music lovers worldwide.</p>
          </div>
          
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="spinner-container" id="spinnerContainer">
    <div class="spinner"></div>
  </div>
  
  <div class="player-controls">
    <div class="now-playing">
      <img src="" alt="Now Playing" class="now-playing-image" id="nowPlayingImage">
      <div class="now-playing-info">
        <div class="now-playing-title" id="nowPlayingTitle">Not Playing</div>
        <div class="now-playing-artist" id="nowPlayingArtist">Search for a song</div>
      </div>
    </div>
    
    <div class="player-center">
      <div class="player-buttons">
        <i class="fas fa-step-backward player-button" id="prevBtn"></i>
        <i class="fas fa-play player-button play-pause" id="playBtn"></i>
        <i class="fas fa-step-forward player-button" id="nextBtn"></i>
      </div>
      
      <div class="player-progress">
        <span class="progress-time" id="currentTime">0:00</span>
        <div class="progress-bar" id="progressBar">
          <div class="progress-fill" id="progressFill"></div>
          <div class="progress-handle"></div>
        </div>
        <span class="progress-time" id="duration">0:00</span>
      </div>
    </div>
    
    <div class="player-actions">
      <i class="fas fa-heart fav-btn" id="nowPlayingFavBtn" title="Add to Favorites"></i>
    </div>
  </div>
  
  <div id="youtube-player"></div>
  
  <script>
    const apiKey = "AIzaSyBmpBJ7bU38l7gDWiv2BCSyC7A5ItNYhWg";
    let player;
    let currentTrack = null;
    let searchResults = [];
    let currentTrackIndex = -1;
    let progressInterval;
    
    // Initialize data stores
    let favorites = JSON.parse(localStorage.getItem('harmonyFavorites')) || [];
    let history = JSON.parse(localStorage.getItem('harmonyHistory')) || [];
    
    document.addEventListener('DOMContentLoaded', function() {
      initYouTubePlayer();
      setupEventListeners();
      updateCounters();
      showTab('home');
      
      // Initialize sidebar now playing
      updateSidebarNowPlaying();
    });

    function initYouTubePlayer() {
      const tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      const firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
      
      window.onYouTubeIframeAPIReady = function() {
        player = new YT.Player('youtube-player', {
          height: '0',
          width: '0',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          },
          playerVars: {
            autoplay: 1,
            controls: 0
          }
        });
      };
    }

    function onPlayerReady() {
      console.log('Player ready');
    }

    function onPlayerStateChange(event) {
      const spinner = document.getElementById('spinnerContainer');
      
      // Hide spinner when playing or paused
      if (event.data === YT.PlayerState.PLAYING || 
          event.data === YT.PlayerState.PAUSED ||
          event.data === YT.PlayerState.ENDED) {
        spinner.style.display = 'none';
        
        // Start progress timer when playing
        if (event.data === YT.PlayerState.PLAYING) {
          startProgressTimer();
          updatePlayPauseButton(true);
        } else if (event.data === YT.PlayerState.PAUSED) {
          clearInterval(progressInterval);
          updatePlayPauseButton(false);
        }
      }
      
      // Show spinner only when buffering
      if (event.data === YT.PlayerState.BUFFERING) {
        spinner.style.display = 'flex';
      }
      
      // Track when video ends
      if (event.data === YT.PlayerState.ENDED) {
        playNextTrack();
      }
    }

    function setupEventListeners() {
      // Search
      document.getElementById('searchInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') searchYouTube(this.value);
      });
      
      // Player controls
      document.getElementById('playBtn').addEventListener('click', togglePlayPause);
      document.getElementById('nextBtn').addEventListener('click', playNextTrack);
      document.getElementById('prevBtn').addEventListener('click', playPreviousTrack);
      
      // Progress bar
      document.getElementById('progressBar').addEventListener('click', function(e) {
        const percent = e.offsetX / this.offsetWidth;
        seekTo(percent);
      });
      
      // Sidebar toggle
      document.getElementById('menuToggle').addEventListener('click', function() {
        document.getElementById('sidebar').classList.toggle('active');
      });
      
      // Navigation tabs
      document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', function() {
          const tab = this.dataset.tab;
          showTab(tab);
          
          // Update active state
          document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
          this.classList.add('active');
          
          // Close sidebar on mobile
          if (window.innerWidth <= 992) {
            document.getElementById('sidebar').classList.remove('active');
          }
        });
      });
      
      // Player actions
      document.getElementById('nowPlayingFavBtn').addEventListener('click', toggleCurrentFavorite);
    }

    async function searchYouTube(query) {
      if (!query.trim()) return;
      
      document.getElementById('spinnerContainer').style.display = 'flex';
      document.getElementById('searchResults').classList.remove('active');
      
      try {
        const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=15&q=${encodeURIComponent(query + " song")}&type=video&key=${apiKey}`);
        const data = await response.json();
        
        if (data.items && data.items.length > 0) {
          searchResults = data.items.map(item => ({
            id: item.id.videoId,
            title: item.snippet.title.replace(/&#39;/g, "'").replace(/&quot;/g, '"'),
            channel: item.snippet.channelTitle,
            thumbnail: item.snippet.thumbnails.medium ? item.snippet.thumbnails.medium.url : item.snippet.thumbnails.default.url
          }));
          
          displaySearchResults();
        } else {
          // No results found
          const container = document.getElementById('resultsContainer');
          container.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-music"></i>
              <h3>No results found</h3>
              <p>Try a different search term</p>
            </div>
          `;
          document.getElementById('searchResults').classList.add('active');
        }
      } catch (error) {
        console.error('Search error:', error);
        const container = document.getElementById('resultsContainer');
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-exclamation-circle"></i>
            <h3>Search Error</h3>
            <p>Failed to fetch results. Please try again later.</p>
          </div>
        `;
        document.getElementById('searchResults').classList.add('active');
      } finally {
        document.getElementById('spinnerContainer').style.display = 'none';
      }
    }

    function displaySearchResults() {
      const container = document.getElementById('resultsContainer');
      container.innerHTML = '';
      
      if (searchResults.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-music"></i>
            <h3>No results found</h3>
            <p>Try a different search term</p>
          </div>
        `;
        document.getElementById('searchResults').classList.add('active');
        return;
      }
      
      searchResults.forEach((result, index) => {
        const isFavorite = favorites.some(fav => fav.id === result.id);
        
        const card = document.createElement('div');
        card.className = 'result-card';
        card.dataset.index = index;
        
        card.innerHTML = `
          <div class="card-actions">
            <div class="action-btn favorite-btn ${isFavorite ? 'favorited' : ''}" data-id="${result.id}" title="Add to Favorites">
              <i class="fas fa-heart"></i>
            </div>
          </div>
          <img src="${result.thumbnail}" alt="${result.title}" class="result-image" onerror="this.src='https://i.ytimg.com/vi/${result.id}/hqdefault.jpg'">
          <h3 class="result-title">${result.title}</h3>
          <p class="result-channel">${result.channel}</p>
          <div class="play-button">
            <i class="fas fa-play"></i>
          </div>
        `;
        
        card.addEventListener('click', (e) => {
          if (!e.target.closest('.card-actions')) {
            playTrack(index);
          }
        });
        
        const favBtn = card.querySelector('.favorite-btn');
        favBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          toggleFavorite(result, this);
        });
        
        container.appendChild(card);
      });
      
      document.getElementById('searchResults').classList.add('active');
    }
    
    function displayFavorites() {
      const container = document.getElementById('favoritesContainer');
      container.innerHTML = '';
      
      if (favorites.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-heart"></i>
            <h3>No favorites yet</h3>
            <p>Add songs to your favorites by clicking the heart icon</p>
          </div>
        `;
        return;
      }
      
      favorites.forEach((fav, index) => {
        const card = document.createElement('div');
        card.className = 'result-card';
        card.dataset.id = fav.id;
        
        card.innerHTML = `
          <div class="card-actions">
            <div class="action-btn favorite-btn favorited" data-id="${fav.id}" title="Remove from Favorites">
              <i class="fas fa-heart"></i>
            </div>
          </div>
          <img src="${fav.thumbnail}" alt="${fav.title}" class="result-image" onerror="this.src='https://i.ytimg.com/vi/${fav.id}/hqdefault.jpg'">
          <h3 class="result-title">${fav.title}</h3>
          <p class="result-channel">${fav.channel}</p>
          <div class="play-button">
            <i class="fas fa-play"></i>
          </div>
        `;
        
        card.addEventListener('click', (e) => {
          if (!e.target.closest('.card-actions')) {
            playFavorite(fav.id);
          }
        });
        
        const favBtn = card.querySelector('.favorite-btn');
        favBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          toggleFavorite(fav, this);
        });
        
        container.appendChild(card);
      });
    }
    
    function displayHistory() {
      const container = document.getElementById('historyContainer');
      container.innerHTML = '';
      
      if (history.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-history"></i>
            <h3>No history yet</h3>
            <p>Play some songs to see them here</p>
          </div>
        `;
        return;
      }
      
      // Display in reverse order (most recent first)
      [...history].reverse().forEach((item, index) => {
        const card = document.createElement('div');
        card.className = 'result-card';
        card.dataset.id = item.id;
        
        card.innerHTML = `
          <img src="${item.thumbnail}" alt="${item.title}" class="result-image" onerror="this.src='https://i.ytimg.com/vi/${item.id}/hqdefault.jpg'">
          <h3 class="result-title">${item.title}</h3>
          <p class="result-channel">${item.channel}</p>
          <div class="play-button">
            <i class="fas fa-play"></i>
          </div>
        `;
        
        card.addEventListener('click', () => {
          playTrackById(item.id);
        });
        
        container.appendChild(card);
      });
    }
    
    function playFavorite(id) {
      const favIndex = favorites.findIndex(fav => fav.id === id);
      if (favIndex !== -1) {
        const track = favorites[favIndex];
        playTrackById(track.id);
      }
    }

    function playTrack(index) {
      if (index < 0 || index >= searchResults.length) return;
      
      document.getElementById('spinnerContainer').style.display = 'flex';
      
      currentTrackIndex = index;
      currentTrack = searchResults[index];
      
      // Update now playing info
      updateNowPlaying();
      
      // Add to history
      addToHistory(currentTrack);
      
      player.loadVideoById(currentTrack.id);
    }
    
    function playTrackById(id) {
      // Try to find in search results
      const index = searchResults.findIndex(track => track.id === id);
      if (index !== -1) {
        playTrack(index);
        return;
      }
      
      // Try to find in favorites
      const favIndex = favorites.findIndex(fav => fav.id === id);
      if (favIndex !== -1) {
        const track = favorites[favIndex];
        currentTrackIndex = -1;
        currentTrack = track;
        updateNowPlaying();
        player.loadVideoById(id);
        return;
      }
      
      // Try to find in history
      const historyIndex = history.findIndex(item => item.id === id);
      if (historyIndex !== -1) {
        const track = history[historyIndex];
        currentTrackIndex = -1;
        currentTrack = track;
        updateNowPlaying();
        player.loadVideoById(id);
        return;
      }
      
      // If not found, load directly
      document.getElementById('spinnerContainer').style.display = 'flex';
      
      currentTrackIndex = -1;
      currentTrack = {
        id: id,
        title: 'Unknown Track',
        channel: 'Unknown Artist',
        thumbnail: `https://i.ytimg.com/vi/${id}/hqdefault.jpg`
      };
      
      updateNowPlaying();
      player.loadVideoById(id);
    }
    
    function updateNowPlaying() {
      if (!currentTrack) return;
      
      // Set image with fallback
      const nowPlayingImage = document.getElementById('nowPlayingImage');
      nowPlayingImage.src = currentTrack.thumbnail || `https://i.ytimg.com/vi/${currentTrack.id}/hqdefault.jpg`;
      nowPlayingImage.onerror = function() {
        this.src = 'https://i.ytimg.com/vi/' + currentTrack.id + '/hqdefault.jpg';
      };
      
      document.getElementById('nowPlayingTitle').textContent = currentTrack.title;
      document.getElementById('nowPlayingArtist').textContent = currentTrack.channel || 'Unknown Artist';
      
      // Update favorite button state
      const isFavorite = favorites.some(fav => fav.id === currentTrack.id);
      document.getElementById('nowPlayingFavBtn').classList.toggle('favorited', isFavorite);
      
      // Update sidebar
      updateSidebarNowPlaying();
    }
    
    function updateSidebarNowPlaying() {
      if (!currentTrack) return;
      
      const sidebarImage = document.getElementById('sidebarNowPlayingImage');
      sidebarImage.src = currentTrack.thumbnail || `https://i.ytimg.com/vi/${currentTrack.id}/hqdefault.jpg`;
      sidebarImage.onerror = function() {
        this.src = 'https://i.ytimg.com/vi/' + currentTrack.id + '/hqdefault.jpg';
      };
      
      document.getElementById('sidebarNowPlayingTitle').textContent = currentTrack.title;
      document.getElementById('sidebarNowPlayingArtist').textContent = currentTrack.channel || 'Unknown Artist';
    }

    function togglePlayPause() {
      if (!currentTrack) {
        if (searchResults.length > 0) playTrack(0);
        return;
      }
      
      if (player.getPlayerState() === YT.PlayerState.PLAYING) {
        player.pauseVideo();
      } else {
        player.playVideo();
      }
    }

    function updatePlayPauseButton(playing) {
      const playBtn = document.getElementById('playBtn');
      
      if (playing) {
        playBtn.classList.remove('fa-play');
        playBtn.classList.add('fa-pause');
      } else {
        playBtn.classList.remove('fa-pause');
        playBtn.classList.add('fa-play');
      }
    }

    function playNextTrack() {
      if (searchResults.length === 0) return;
      const nextIndex = (currentTrackIndex + 1) % searchResults.length;
      playTrack(nextIndex);
    }

    function playPreviousTrack() {
      if (searchResults.length === 0) return;
      const prevIndex = (currentTrackIndex - 1 + searchResults.length) % searchResults.length;
      playTrack(prevIndex);
    }

    function startProgressTimer() {
      clearInterval(progressInterval);
      
      progressInterval = setInterval(() => {
        if (!currentTrack || !player.getCurrentTime) return;
        
        const currentTime = player.getCurrentTime();
        const duration = player.getDuration();
        const percent = (currentTime / duration) * 100;
        
        document.getElementById('progressFill').style.width = `${percent}%`;
        document.getElementById('currentTime').textContent = formatTime(currentTime);
        document.getElementById('duration').textContent = formatTime(duration);
      }, 1000);
    }

    function seekTo(percent) {
      if (!player.seekTo) return;
      const duration = player.getDuration();
      player.seekTo(duration * percent);
    }

    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }
    
    // Favorite System
    function toggleFavorite(track, button) {
      const index = favorites.findIndex(fav => fav.id === track.id);
      
      if (index === -1) {
        // Add to favorites
        favorites.push(track);
        if (button) button.classList.add('favorited');
      } else {
        // Remove from favorites
        favorites.splice(index, 1);
        if (button) button.classList.remove('favorited');
      }
      
      // Update now playing if it's the current track
      if (currentTrack && currentTrack.id === track.id) {
        document.getElementById('nowPlayingFavBtn').classList.toggle('favorited', index === -1);
      }
      
      // Update localStorage
      localStorage.setItem('harmonyFavorites', JSON.stringify(favorites));
      
      // Update counters
      updateCounters();
      
      // Update favorites tab if it's active
      if (document.getElementById('favoritesTab').classList.contains('active')) {
        displayFavorites();
      }
    }
    
    function toggleCurrentFavorite() {
      if (!currentTrack) return;
      
      const btn = document.getElementById('nowPlayingFavBtn');
      toggleFavorite(currentTrack, btn);
    }
    
    // History System
    function addToHistory(track) {
      // Make sure we're storing a complete track object
      const historyTrack = {
        id: track.id,
        title: track.title,
        channel: track.channel,
        thumbnail: track.thumbnail || `https://i.ytimg.com/vi/${track.id}/hqdefault.jpg`
      };
      
      // Remove if already exists to prevent duplicates
      const index = history.findIndex(item => item.id === track.id);
      if (index !== -1) {
        history.splice(index, 1);
      }
      
      // Add to the beginning
      history.unshift(historyTrack);
      
      // Keep only last 50 items
      if (history.length > 50) {
        history.pop();
      }
      
      // Save to localStorage
      localStorage.setItem('harmonyHistory', JSON.stringify(history));
      
      // Update counters
      updateCounters();
    }
    
    function updateCounters() {
      document.getElementById('favoritesCount').textContent = favorites.length;
      document.getElementById('historyCount').textContent = history.length;
    }
    
    // Tab Navigation
    function showTab(tabId) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected tab
      const tab = document.getElementById(`${tabId}Tab`);
      if (tab) {
        tab.classList.add('active');
        
        // Load content if needed
        if (tabId === 'favorites') {
          displayFavorites();
        } else if (tabId === 'history') {
          displayHistory();
        }
      }
    }
  </script>
</body>
</html>
